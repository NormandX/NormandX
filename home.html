<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>NormandX</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>
  <div class="logo" onclick="location.href='home.html'">
    <span>Normand</span><span>X</span>
  </div>

  <input class="search" placeholder="Rechercher..." id="search">

  <div class="account" onclick="toggleMenu()">
    <img src="account.png">
  </div>
</header>

<div class="menu" id="menu">
  <a href="favorites.html">â¤ï¸ Favoris</a>
  <a href="history.html">ğŸ“ Historique</a>
  <a onclick="logout()">ğŸšª DÃ©connexion</a>
</div>

<div class="layout">

<aside id="categories">
  <a data-cat="Hetero">HÃ©tÃ©ro</a>
  <a data-cat="MILF">MILF</a>
  <a data-cat="Teen">Teen</a>
  <a data-cat="Anal">Anal</a>
  <a data-cat="Lesbian">Lesbian</a>
  <a data-cat="Gays">Gays</a>
  <a data-cat="Amateur">Amateur</a>
  <a data-cat="Asian">Asian</a>
  <a data-cat="BBW">BBW</a>
  <a data-cat="Fetish">Fetish</a>
  <a data-cat="Hardcore">Hardcore</a>
  <a data-cat="Compilation">Compilation</a>
</aside>

<main>
  <div class="grid" id="grid"></div>
</main>

</div>

<script>
/* ================= USER ================= */
const user = localStorage.getItem("connected") || "guest";
localStorage.setItem("connected", user);

/* ================= MENU ================= */
function toggleMenu(){
  const m = document.getElementById("menu");
  m.style.display = m.style.display === "block" ? "none" : "block";
}
document.addEventListener("click", e=>{
  if(!e.target.closest(".account")) menu.style.display="none";
});
function logout(){
  localStorage.removeItem("connected");
  location.reload();
}

/* ================= DATA ================= */
const videos = [
 {
  id:1,
  t:"Carla Cute 1",
  c:"Hetero",
  poster:"https://via.placeholder.com/640x360?text=Preview+1",
  v:"https://ia601703.us.archive.org/22/items/video-1_20260114/Video1.mp4",
  d:"12:34"
 },
 {
  id:2,
  t:"Ma cousine m'a fait perdre le NNN",
  c:"Hetero",
  poster:"https://via.placeholder.com/640x360?text=Preview+2",
  v:"https://ia601402.us.archive.org/0/items/xnxx-incroyable-blonde-bien-roulee-percee-par-filoufitt-360p/XNXX_incroyable_blonde_bien_roulee_percee_par_filoufitt_360p.mp4",
  d:"18:05"
 },
 {
  id:3,
  t:"Lenny est nul au lit",
  c:"Gays",
  poster:"https://via.placeholder.com/640x360?text=Preview+3",
  v:"https://ia800800.us.archive.org/11/items/xnxx-vixen-tori-black-et-caprice-dans-le-plan-a-trois-le-plus-chaud-que-vous-verrez-jamais-sd/XNXX_vixen_tori_black_et_caprice_dans_le_plan_a_trois_le_plus_chaud_que_vous_verrez_jamais__SD.mp4",
  d:"18:05"
 }
];

localStorage.setItem("videos", JSON.stringify(videos));

let favorites = JSON.parse(localStorage.getItem("fav_"+user) || "[]");
let currentList = [...videos];

const grid = document.getElementById("grid");

/* ================= RENDER ================= */
function render(list){
  grid.innerHTML = "";

  list.forEach(v=>{
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <div class="thumb">
        <img src="${v.poster}">
        <video muted playsinline preload="metadata">
          <source src="${v.v}" type="video/mp4">
        </video>
        <span class="duration">${v.d}</span>
      </div>

      <div class="fav-row">
        <button class="fav-btn ${favorites.includes(v.id)?"active":""}">â¤</button>
      </div>

      <p>${v.t}</p>
      <div class="meta">
        <span>${v.c}</span>
      </div>
    `;

    /* === NAVIGATION === */
    card.addEventListener("click", ()=>{
      addHistory(v.id);
      location.href = "video.html?id=" + v.id;
    });

    /* === FAVORI === */
    card.querySelector(".fav-btn").addEventListener("click", e=>{
      e.stopPropagation();
      toggleFav(v.id, e.target);
    });

    /* === PREVIEW PC + MOBILE === */
    const thumb = card.querySelector(".thumb");
    const video = thumb.querySelector("video");
    const img = thumb.querySelector("img");

    const start = ()=>{
      video.currentTime = 0.1;
      video.play();
      video.style.opacity = 1;
      img.style.opacity = 0;
    };

    const stop = ()=>{
      video.pause();
      video.style.opacity = 0;
      img.style.opacity = 1;
    };

    thumb.addEventListener("mouseenter", start);
    thumb.addEventListener("mouseleave", stop);
    thumb.addEventListener("touchstart", start, {passive:true});
    thumb.addEventListener("touchend", stop);

    grid.appendChild(card);
  });
}

/* ================= FAVORIS ================= */
function toggleFav(id, btn){
  if(favorites.includes(id)){
    favorites = favorites.filter(x=>x!==id);
    btn.classList.remove("active");
  }else{
    favorites.push(id);
    btn.classList.add("active");
  }
  localStorage.setItem("fav_"+user, JSON.stringify(favorites));
}

/* ================= HISTORY ================= */
function addHistory(id){
  let h = JSON.parse(localStorage.getItem("history_"+user) || "[]");
  h = h.filter(x=>x!==id);
  h.unshift(id);
  localStorage.setItem("history_"+user, JSON.stringify(h));
}

/* ================= SEARCH ================= */
document.getElementById("search").addEventListener("input", e=>{
  const q = e.target.value.toLowerCase();
  currentList = videos.filter(v=>v.t.toLowerCase().includes(q));
  render(currentList);
});

/* ================= FILTER ================= */
document.querySelectorAll("#categories a").forEach(a=>{
  a.addEventListener("click", ()=>{
    currentList = videos.filter(v=>v.c === a.dataset.cat);
    render(currentList);
  });
});

/* ================= INIT ================= */
render(videos);
</script>

</body>
</html>
