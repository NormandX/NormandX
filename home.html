<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>NormandX</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
 <div class="logo" onclick="location.href='home.html'"><span>Normand</span><span>X</span></div>
 <input class="search" placeholder="Rechercher..." oninput="search(this.value)">
 <div class="account" onclick="toggleMenu()">
  <img src="account.png">
 </div>
</header>

<div class="menu" id="menu">
 <a href="account.html">Compte</a>
 <a href="favorites.html">Favoris</a>
 <a onclick="logout()">D√©connexion</a>
</div>

<div class="layout">
<aside>
 <a onclick="filter('Hetero')">H√©t√©ro</a>
 <a onclick="filter('MILF')">MILF</a>
 <a onclick="filter('Teen')">Teen</a>
 <a onclick="filter('Anal')">Anal</a>
 <a onclick="filter('Lesbian')">Lesbian</a>
 <a onclick="filter('Gays')">Gays</a>
 <a onclick="filter('Amateur')">Amateur</a>
 <a onclick="filter('Asian')">Asian</a>
 <a onclick="filter('BBW')">BBW</a>
 <a onclick="filter('Fetish')">Fetish</a>
 <a onclick="filter('Hardcore')">Hardcore</a>
 <a onclick="filter('Compilation')">Compilation</a>
</aside>

<main>
 <div class="grid" id="grid"></div>
</main>
</div>

<script>
const user=localStorage.getItem("connected");
if(!user) location.href="auth.html";

function toggleMenu(){
 menu.style.display=menu.style.display==="block"?"none":"block";
}
function logout(){
 localStorage.removeItem("connected");
 location.href="auth.html";
}

const videos=[
 {id:1,t:"Vid√©o 1",c:"Hetero",i:"thumbs/1.jpg",v:"videos/1.mp4",views:0},
 {id:2,t:"Vid√©o 2",c:"MILF",i:"thumbs/2.jpg",v:"videos/2.mp4",views:0}
];
localStorage.setItem("videos",JSON.stringify(videos));

function render(list){
 grid.innerHTML="";
 const likes=JSON.parse(localStorage.getItem("likes_"+user)||"[]");
 const favs=JSON.parse(localStorage.getItem("fav_"+user)||"[]");
 list.forEach(v=>{
  grid.innerHTML+=`
  <div class="card">
   <img src="${v.i}" onclick="openVideo(${v.id})">
   <p>${v.t}</p>
   <div class="meta">
    <span>${v.views} vues</span>
    <span>${v.c}</span>
   </div>
   <div class="actions">
    <button class="like ${likes.includes(v.id)?'active':''}" onclick="like(${v.id},this)">üëç</button>
    <button class="fav ${favs.includes(v.id)?'active':''}" onclick="fav(${v.id},this)">‚ù§</button>
   </div>
  </div>`;
 });
}
render(videos);

function openVideo(id){
 let vids=JSON.parse(localStorage.getItem("videos"));
 let v=vids.find(x=>x.id===id);
 v.views++;
 localStorage.setItem("videos",JSON.stringify(vids));

 let h=JSON.parse(localStorage.getItem("history_"+user)||"[]");
 h.unshift(id);h=[...new Set(h)];
 localStorage.setItem("history_"+user,JSON.stringify(h));
 location.href="video.html?id="+id;
}

function search(q){
 render(videos.filter(v=>v.t.toLowerCase().includes(q.toLowerCase())));
}
function filter(c){render(videos.filter(v=>v.c===c));}

function like(id,btn){
 let l=JSON.parse(localStorage.getItem("likes_"+user)||"[]");
 l.includes(id)?l=l.filter(x=>x!==id):l.push(id);
 btn.classList.toggle("active");
 localStorage.setItem("likes_"+user,JSON.stringify(l));
}
function fav(id,btn){
 let f=JSON.parse(localStorage.getItem("fav_"+user)||"[]");
 f.includes(id)?f=f.filter(x=>x!==id):f.push(id);
 btn.classList.toggle("active");
 localStorage.setItem("fav_"+user,JSON.stringify(f));
}
</script>
</body>
</html>
