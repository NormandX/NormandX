<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>NormandX</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>
  <div class="logo" onclick="location.href='home.html'">
    <span>Normand</span><span>X</span>
  </div>

  <input class="search" placeholder="Rechercher..." oninput="search(this.value)">
</header>

<div class="layout">

<aside>
  <a onclick="filter('Hetero')">Hétéro</a>
  <a onclick="filter('MILF')">MILF</a>
  <a onclick="filter('Teen')">Teen</a>
  <a onclick="filter('Anal')">Anal</a>
  <a onclick="filter('Lesbian')">Lesbian</a>
  <a onclick="filter('Gays')">Gays</a>
  <a onclick="filter('Amateur')">Amateur</a>
  <a onclick="filter('Asian')">Asian</a>
  <a onclick="filter('BBW')">BBW</a>
  <a onclick="filter('Fetish')">Fetish</a>
  <a onclick="filter('Hardcore')">Hardcore</a>
  <a onclick="filter('Compilation')">Compilation</a>
</aside>

<main>
  <div class="grid" id="grid"></div>
</main>

</div>

<script>
/* ===== AUTH ===== */
const user = localStorage.getItem("connected");
if(!user) location.href="auth.html";

/* ===== VIDEOS ===== */
const videos=[
 {
  id:1,
  t:"Carla Cute 1",
  c:"Hetero",
  poster:"https://via.placeholder.com/640x360/111/fff?text=Video+1",
  v:"https://ia601703.us.archive.org/22/items/video-1_20260114/Video1.mp4",
  d:"12:34",
  hd:true,
  isNew:true,
  views:0
 },
 {
  id:2,
  t:"Ma cousine m'a fait perdre le NNN",
  c:"Hetero",
  poster:"https://ic-nss.flixcdn.com/a/MzliYTZhMDJhMWU2ZjNkNjY4NGRmOGI3NTI1MjQ1Zjg/webp%2Cs%28w%3A704%2Ch%3A440%29/xc/7k/7k6BvI/frame/original/23.jpg",
  v:"https://ia601402.us.archive.org/0/items/xnxx-incroyable-blonde-bien-roulee-percee-par-filoufitt-360p/XNXX_incroyable_blonde_bien_roulee_percee_par_filoufitt_360p.mp4",
  d:"18:05",
  hd:true,
  isNew:false,
  views:0
 }
];

/* ===== FAVORIS ===== */
let fav = JSON.parse(localStorage.getItem("fav_"+user) || "[]");

function toggleFav(e,id){
  e.stopPropagation();
  fav.includes(id)
    ? fav = fav.filter(x=>x!==id)
    : fav.push(id);
  localStorage.setItem("fav_"+user,JSON.stringify(fav));
  updateFavUI();
}

function updateFavUI(){
  document.querySelectorAll(".fav-btn").forEach(b=>{
    b.classList.toggle("active", fav.includes(+b.dataset.id));
  });
}

/* ===== RENDER ===== */
const grid=document.getElementById("grid");

function render(list){
  grid.innerHTML="";
  list.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";
    card.onclick=()=>openVideo(v.id);

    card.innerHTML=`
      <div class="thumb"
        onmouseenter="previewStart(this)"
        onmouseleave="previewStop(this)"
        ontouchstart="previewStart(this)"
        ontouchend="previewStop(this)">
        
        <img src="${v.poster}"
          onerror="this.src='https://via.placeholder.com/640x360/000/fff?text=Preview'">

        <video muted playsinline preload="none" data-src="${v.v}"></video>

        ${v.hd?'<span class="badge">HD</span>':''}
        ${v.isNew?'<span class="badge new">NEW</span>':''}
        <span class="duration">${v.d}</span>
      </div>

      <div class="fav-row">
        <button class="fav-btn" data-id="${v.id}"
          onclick="toggleFav(event,${v.id})">❤</button>
      </div>

      <p>${v.t}</p>

      <div class="meta">
        <span>${v.views} vues</span>
        <span>${v.c}</span>
      </div>
    `;
    grid.appendChild(card);
  });
  updateFavUI();
}

render(videos);

/* ===== PREVIEW PC + MOBILE ===== */
function previewStart(el){
  const v=el.querySelector("video");
  const i=el.querySelector("img");
  if(!v.src) v.src=v.dataset.src;
  v.currentTime=0.1;
  v.play();
  v.style.opacity=1;
  i.style.opacity=0;
}
function previewStop(el){
  const v=el.querySelector("video");
  const i=el.querySelector("img");
  v.pause();
  v.style.opacity=0;
  i.style.opacity=1;
}

/* ===== OPEN VIDEO + HISTORIQUE ===== */
function openVideo(id){
  let h=JSON.parse(localStorage.getItem("history_"+user)||"[]");
  h.unshift(id);
  h=[...new Set(h)];
  localStorage.setItem("history_"+user,JSON.stringify(h));
  location.href="video.html?id="+id;
}

/* ===== SEARCH / FILTER ===== */
function search(q){
  render(videos.filter(v=>v.t.toLowerCase().includes(q.toLowerCase())));
}
function filter(c){
  render(videos.filter(v=>v.c===c));
}
</script>

</body>
</html>